<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Monitor Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Onest:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Onest', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #0a0a0f 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .bg-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.3;
            animation: float 20s ease-in-out infinite;
        }

        .bg-orb-1 {
            width: 400px;
            height: 400px;
            background: rgba(239, 68, 68, 0.3);
            top: 20%;
            left: 20%;
            animation-delay: 0s;
        }

        .bg-orb-2 {
            width: 350px;
            height: 350px;
            background: rgba(59, 130, 246, 0.3);
            bottom: 20%;
            right: 20%;
            animation-delay: 5s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(50px, -50px) scale(1.1); }
            66% { transform: translate(-30px, 30px) scale(0.9); }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header */
        header {
            margin-bottom: 3rem;
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        h1 {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #ffffff 0%, #a0a0a0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #888;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .status-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 50px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        .status-connected .status-dot {
            background: #22c55e;
        }

        .status-disconnected .status-dot {
            background: #ef4444;
            animation: none;
        }

        .last-update {
            color: #666;
            font-size: 0.75rem;
            font-family: 'JetBrains Mono', monospace;
            margin-top: 0.5rem;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Card Styles */
        .card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 24px;
            padding: 2rem;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            animation: fadeIn 0.6s ease-out backwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card:nth-child(1) { animation-delay: 0.1s; }
        .card:nth-child(2) { animation-delay: 0.2s; }
        .card:nth-child(3) { animation-delay: 0.3s; }
        .card:nth-child(4) { animation-delay: 0.4s; }
        .card:nth-child(5) { animation-delay: 0.5s; }

        .card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .card:hover::before {
            opacity: 1;
        }

        .card:hover {
            transform: translateY(-5px);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1.5rem;
        }

        .card-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
        }

        .card-icon {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .card-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 3.5rem;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 0.5rem;
        }

        .card-unit {
            font-size: 1.25rem;
            color: #666;
            margin-left: 0.5rem;
        }

        .card-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .status-text {
            font-size: 0.875rem;
            font-weight: 600;
        }

        /* Heart Rate Card */
        .heart-rate .card-icon {
            background: rgba(239, 68, 68, 0.1);
        }

        .heart-rate .card-value {
            color: #ef4444;
        }

        .heart-rate:hover {
            border-color: rgba(239, 68, 68, 0.3);
        }

        /* Fall Detection Card */
        .fall-detection .card-icon {
            background: rgba(34, 197, 94, 0.1);
        }

        .fall-detection.alert .card-icon {
            background: rgba(239, 68, 68, 0.2);
            animation: pulse 1s ease-in-out infinite;
        }

        .fall-detection.alert {
            border-color: rgba(239, 68, 68, 0.5);
            background: rgba(239, 68, 68, 0.05);
        }

        .fall-status {
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 1rem;
        }

        .fall-message {
            color: #888;
            font-size: 0.875rem;
            line-height: 1.6;
            margin-top: 1rem;
        }

        /* GPS Card */
        .gps-location {
            grid-column: span 2;
        }

        .gps-location .card-icon {
            background: rgba(168, 85, 247, 0.1);
        }

        .gps-coords {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .coord-item {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .coord-label {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .coord-label.lat {
            background: rgba(168, 85, 247, 0.1);
            color: #a855f7;
        }

        .coord-label.lon {
            background: rgba(236, 72, 153, 0.1);
            color: #ec4899;
        }

        .coord-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .coord-value.lat-val {
            color: #a855f7;
        }

        .coord-value.lon-val {
            color: #ec4899;
        }

        .map-button {
            margin-top: 1.5rem;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .map-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.3);
        }

        .map-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* System Status Card */
        .system-status .card-icon {
            background: rgba(100, 100, 100, 0.1);
        }

        .status-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .status-item:last-child {
            border-bottom: none;
        }

        .status-label {
            color: #888;
            font-size: 0.875rem;
        }

        .status-value {
            font-weight: 600;
            font-size: 0.875rem;
        }

        /* Colors */
        .text-green { color: #22c55e; }
        .text-red { color: #ef4444; }
        .text-orange { color: #f59e0b; }
        .text-gray { color: #666; }

        .bg-green { background: #22c55e; }
        .bg-red { background: #ef4444; }
        .bg-orange { background: #f59e0b; }

        /* Footer */
        footer {
            text-align: center;
            color: #666;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            padding: 2rem 0;
            animation: fadeIn 0.8s ease-out 0.5s backwards;
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .gps-location {
                grid-column: span 1;
            }

            .gps-coords {
                grid-template-columns: 1fr;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <div class="bg-orb bg-orb-1"></div>
        <div class="bg-orb bg-orb-2"></div>
    </div>

    <div class="container">
        <header>
            <div class="header-content">
                <div>
                    <h1>Health Monitor</h1>
                    <p class="subtitle">Real-time Vital Signs Dashboard</p>
                </div>
                <div>
                    <div id="statusBadge" class="status-badge status-disconnected">
                        <div class="status-dot"></div>
                        <span id="statusText">DISCONNECTED</span>
                    </div>
                    <div class="last-update" id="lastUpdate"></div>
                </div>
            </div>
        </header>

        <div class="dashboard-grid">
            <!-- Heart Rate Card -->
            <div class="card heart-rate">
                <div class="card-header">
                    <div>
                        <div class="card-title">Heart Rate</div>
                        <div>
                            <span class="card-value" id="heartRate">--</span>
                            <span class="card-unit">BPM</span>
                        </div>
                    </div>
                    <div class="card-icon">
                        ‚ù§Ô∏è
                    </div>
                </div>
                <div class="card-status">
                    <div class="status-indicator bg-gray" id="hrIndicator"></div>
                    <div class="status-text text-gray" id="hrStatus">No Data</div>
                </div>
            </div>

            <!-- Fall Detection Card -->
            <div class="card fall-detection" id="fallCard">
                <div class="card-header">
                    <div>
                        <div class="card-title">Fall Detection</div>
                        <div class="fall-status" id="fallStatus">
                            <span style="color: #22c55e;">‚úì Normal</span>
                        </div>
                    </div>
                    <div class="card-icon" id="fallIcon">
                        ‚úì
                    </div>
                </div>
                <div class="fall-message" id="fallMessage">
                    System monitoring for falls. All sensors operational and functioning normally.
                </div>
            </div>

            <!-- GPS Location Card -->
            <div class="card gps-location">
                <div class="card-header">
                    <div style="flex: 1;">
                        <div class="card-title">GPS Location</div>
                        <div class="gps-coords">
                            <div class="coord-item">
                                <div class="coord-label lat">LAT</div>
                                <div class="coord-value lat-val" id="latitude">--</div>
                            </div>
                            <div class="coord-item">
                                <div class="coord-label lon">LON</div>
                                <div class="coord-value lon-val" id="longitude">--</div>
                            </div>
                        </div>
                        <button class="map-button" id="mapButton" onclick="openMap()" disabled>
                            <span>üìç</span>
                            <span>Open in Google Maps</span>
                        </button>
                    </div>
                    <div class="card-icon">
                        üìç
                    </div>
                </div>
            </div>

            <!-- System Status Card -->
            <div class="card system-status">
                <div class="card-header">
                    <div style="flex: 1;">
                        <div class="card-title">System Status</div>
                        <div class="status-list">
                            <div class="status-item">
                                <span class="status-label">Data Connection</span>
                                <span class="status-value text-gray" id="sysConnection">Inactive</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Heart Monitor</span>
                                <span class="status-value text-gray" id="sysHeart">Offline</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">GPS Module</span>
                                <span class="status-value text-gray" id="sysGps">Offline</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Fall Detection</span>
                                <span class="status-value text-green" id="sysFall">Active</span>
                            </div>
                        </div>
                    </div>
                    <div class="card-icon">
                        ‚öôÔ∏è
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>Health Monitor Dashboard v1.0 ‚Ä¢ Real-time Monitoring System</p>
            <p style="margin-top: 0.5rem;">Data updates every 2 seconds</p>
        </footer>
    </div>

    <script>
        // Configuration
        const API_URL = 'https://twin-rescue.vercel.app/api/data'; // Change this to your API endpoint
        const UPDATE_INTERVAL = 2000; // 2 seconds

        let healthData = {
            bpm: 0,
            temperature: 0,
            fall: false,
            timestamp: null
        };

        // Fetch data from API
        async function fetchHealthData() {
            try {
                const response = await fetch(API_URL);
                if (response.ok) {
                    const data = await response.json();
                    healthData.bpm = data.bpm || 0;
                    healthData.temperature = data.temperature || 0;
                    healthData.fall = data.fall || false;
                    healthData.timestamp = data.timestamp || null;
                    updateDashboard();
                    updateConnectionStatus(true);
                } else {
                    updateConnectionStatus(false);
                }
            } catch (error) {
                console.error('Error fetching data:', error);
                updateConnectionStatus(false);
            }
        }

        // Update dashboard UI
        function updateDashboard() {
            // Update Heart Rate
            document.getElementById('heartRate').textContent = healthData.bpm || '--';
            updateHeartRateStatus(healthData.bpm);

            // Update SpO2
            document.getElementById('spo2').textContent = healthData.spo2 || '--';
            updateSpO2Status(healthData.spo2);
            document.getElementById('spo2Progress').style.width = `${healthData.spo2}%`;

            // Update Fall Detection
            updateFallStatus(healthData.fall);

            // Update GPS
            const lat = healthData.latitude ? healthData.latitude.toFixed(6) : '--';
            const lon = healthData.longitude ? healthData.longitude.toFixed(6) : '--';
            document.getElementById('latitude').textContent = lat;
            document.getElementById('longitude').textContent = lon;

            // Enable/disable map button
            const mapButton = document.getElementById('mapButton');
            if (healthData.latitude && healthData.longitude) {
                mapButton.disabled = false;
            } else {
                mapButton.disabled = true;
            }

            // Update system status
            updateSystemStatus();

            // Update timestamp
            const now = new Date();
            document.getElementById('lastUpdate').textContent = `Last update: ${now.toLocaleTimeString()}`;
        }

        // Update heart rate status
        function updateHeartRateStatus(hr) {
            const indicator = document.getElementById('hrIndicator');
            const status = document.getElementById('hrStatus');

            if (hr === 0) {
                indicator.className = 'status-indicator bg-gray';
                status.className = 'status-text text-gray';
                status.textContent = 'No Data';
            } else if (hr < 60) {
                indicator.className = 'status-indicator bg-orange';
                status.className = 'status-text text-orange';
                status.textContent = 'Low';
            } else if (hr > 100) {
                indicator.className = 'status-indicator bg-orange';
                status.className = 'status-text text-orange';
                status.textContent = 'High';
            } else {
                indicator.className = 'status-indicator bg-green';
                status.className = 'status-text text-green';
                status.textContent = 'Normal';
            }
        }

        // Update SpO2 status
        function updateSpO2Status(spo2) {
            const indicator = document.getElementById('spo2Indicator');
            const status = document.getElementById('spo2Status');

            if (spo2 === 0) {
                indicator.className = 'status-indicator bg-gray';
                status.className = 'status-text text-gray';
                status.textContent = 'No Data';
            } else if (spo2 < 90) {
                indicator.className = 'status-indicator bg-red';
                status.className = 'status-text text-red';
                status.textContent = 'Critical';
            } else if (spo2 < 95) {
                indicator.className = 'status-indicator bg-orange';
                status.className = 'status-text text-orange';
                status.textContent = 'Low';
            } else {
                indicator.className = 'status-indicator bg-green';
                status.className = 'status-text text-green';
                status.textContent = 'Normal';
            }
        }

        // Update fall detection status
        function updateFallStatus(detected) {
            const card = document.getElementById('fallCard');
            const icon = document.getElementById('fallIcon');
            const status = document.getElementById('fallStatus');
            const message = document.getElementById('fallMessage');

            if (detected) {
                card.classList.add('alert');
                icon.textContent = '‚ö†Ô∏è';
                status.innerHTML = '<span style="color: #ef4444;">‚ö†Ô∏è FALL DETECTED!</span>';
                message.textContent = '‚ö†Ô∏è Fall detected! Immediate attention required. Check patient status and location.';
                message.style.color = '#ef4444';
            } else {
                card.classList.remove('alert');
                icon.textContent = '‚úì';
                status.innerHTML = '<span style="color: #22c55e;">‚úì Normal</span>';
                message.textContent = 'System monitoring for falls. All sensors operational and functioning normally.';
                message.style.color = '#888';
            }
        }

        // Update connection status
        function updateConnectionStatus(connected) {
            const badge = document.getElementById('statusBadge');
            const text = document.getElementById('statusText');

            if (connected) {
                badge.className = 'status-badge status-connected';
                text.textContent = 'LIVE';
            } else {
                badge.className = 'status-badge status-disconnected';
                text.textContent = 'DISCONNECTED';
            }
        }

        // Update system status panel
        function updateSystemStatus() {    
          const isConnected = healthData.bpm > 0;    
        
          document.getElementById('sysConnection').textContent =
            isConnected ? 'Active' : 'Inactive';
          document.getElementById('sysConnection').className =
            `status-value ${isConnected ? 'text-green' : 'text-red'}`;
        
          document.getElementById('sysHeart').textContent =
            healthData.bpm > 0 ? 'Online' : 'Offline';
          document.getElementById('sysHeart').className =
            `status-value ${healthData.bpm > 0 ? 'text-green' : 'text-gray'}`;
        
          document.getElementById('sysFall').textContent = 'Active';
          document.getElementById('sysFall').className = 'status-value text-green';
        }

        // Open Google Maps
        function openMap() {
            if (healthData.latitude && healthData.longitude) {
                const url = `https://www.google.com/maps?q=${healthData.latitude},${healthData.longitude}`;
                window.open(url, '_blank');
            }
        }

        // Start polling for data
        setInterval(fetchHealthData, UPDATE_INTERVAL);

        // Initial fetch
        fetchHealthData();

        // For testing purposes - simulate data (remove this in production)
        function simulateData() {
            healthData = {
                heartRate: Math.floor(Math.random() * 40) + 60, // 60-100
                spo2: Math.floor(Math.random() * 5) + 95, // 95-100
                fallDetected: Math.random() > 0.95, // 5% chance
                latitude: 13.0827 + (Math.random() - 0.5) * 0.01,
                longitude: 80.2707 + (Math.random() - 0.5) * 0.01,
                timestamp: new Date().toISOString()
            };
            updateDashboard();
            updateConnectionStatus(true);
        }

        // Uncomment to test with simulated data
        // setInterval(simulateData, 2000);
        // simulateData();
    </script>
</body>
</html>